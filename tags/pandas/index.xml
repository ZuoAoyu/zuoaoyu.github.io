<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Pandas on 侠客</title><link>https://o5o.me/tags/pandas/</link><description>Recent content in Pandas on 侠客</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Wed, 17 May 2023 14:34:00 +0800</lastBuildDate><atom:link href="https://o5o.me/tags/pandas/index.xml" rel="self" type="application/rss+xml"/><item><title>Joyful Pandas 索引 练习3.2 巧克力数据集</title><link>https://o5o.me/post/joyful_pandas_3_2_indexes/</link><pubDate>Wed, 17 May 2023 14:34:00 +0800</pubDate><guid>https://o5o.me/post/joyful_pandas_3_2_indexes/</guid><description>题目 现有一份关于巧克力评价的数据集：
1 2 df = pd.read_csv(&amp;#39;../data/chocolate.csv&amp;#39;) df.head(3) 把列索引名中的\n替换为空格。 巧克力Rating评分为1至5，每0.25分一档，请选出2.75分及以下且可可含量Cocoa Percent高于中位数的样本。 将Review Date和Company Location设为索引后，选出Review Date在2012年之后且Company Location不属于France, Canada, Amsterdam, Belgium的样本。 第 1 问 1 2 df.columns = df.columns.map(lambda x: x.replace(&amp;#39;\n&amp;#39;, &amp;#39; &amp;#39;)) df.head() 第 2 问 1 2 3 cocoa_percent_median = df[&amp;#34;Cocoa Percent&amp;#34;].apply(lambda x: float(x[:-1]) / 100).median() df[(df.Rating &amp;lt;= 2.75) &amp;amp; (df[&amp;#34;Cocoa Percent&amp;#34;].apply(lambda x: float(x[:-1]) / 100) &amp;gt; cocoa_percent_median)] 第 3 问 将Review Date和Company Location设为索引后，选出Review Date在2012年之后且Company Location不属于France, Canada, Amsterdam, Belgium的样本。</description></item><item><title>Joyful Pandas 索引 练习3.1 公司员工数据集</title><link>https://o5o.me/post/joyful_pandas_3_1_indexes/</link><pubDate>Wed, 17 May 2023 11:25:00 +0800</pubDate><guid>https://o5o.me/post/joyful_pandas_3_1_indexes/</guid><description>题目 现有一份公司员工数据集：
1 2 df = pd.read_csv(&amp;#39;../data/company.csv&amp;#39;) df.head(3) 分别只使用query和loc选出年龄不超过四十岁且工作部门为Dairy或Bakery的男性。 选出员工ID号为奇数所在行的第1、第3和倒数第2列。 按照以下步骤进行索引操作： 把后三列设为索引后交换内外两层 恢复中间层索引 修改外层索引名为Gender 用下划线合并两层行索引 把行索引拆分为原状态 修改索引名为原表名称 恢复默认索引并将列保持为原表的相对位置 第 1 问 使用query
1 df.query(&amp;#39;(age &amp;lt;= 40) &amp;amp; (department in [&amp;#34;Dairy&amp;#34;, &amp;#34;Bakery&amp;#34;]) &amp;amp; (gender == &amp;#34;M&amp;#34;)&amp;#39;) 使用loc
1 2 3 4 5 condition_1 = df.age &amp;lt;= 40 condition_2_1 = df.department == &amp;#34;Dairy&amp;#34; condition_2_2 = df.department == &amp;#34;Bakery&amp;#34; condition_3 = df.gender == &amp;#34;M&amp;#34; df.loc[condition_1 &amp;amp; (condition_2_1 | condition_2_2) &amp;amp; condition_3] 第 2 问 题目里这句有点不好理解: 选出员工ID号为奇数所在行的第1、第3和倒数第2列。</description></item></channel></rss>