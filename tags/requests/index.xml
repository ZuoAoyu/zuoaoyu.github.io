<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>requests on 侠客</title><link>https://o5o.me/tags/requests/</link><description>Recent content in requests on 侠客</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Tue, 16 May 2023 17:29:00 +0800</lastBuildDate><atom:link href="https://o5o.me/tags/requests/index.xml" rel="self" type="application/rss+xml"/><item><title>下载网页图片到本地并替换网页内的图片链接</title><link>https://o5o.me/post/download_images_html/</link><pubDate>Tue, 16 May 2023 17:29:00 +0800</pubDate><guid>https://o5o.me/post/download_images_html/</guid><description>从某信读书下载下来一本电子书, 是一个html文件, 里面包含所有的文字内容, 但里面的图片依然都是在线链接. 本文的目的是把这些图片都下载到本地, 并且把html页面里面的图片链接都替换成本地的链接.
导入预计用到的模块 1 2 3 4 5 6 # 导包 import requests import os import pathlib from lxml import etree import re 读取html文件 1 2 3 4 5 6 base_dir = pathlib.Path(r&amp;#34;D:\Projects\book_hands_on_machine_learning&amp;#34;) file_path = base_dir / &amp;#34;book.html&amp;#34; with open(file_path, &amp;#39;r&amp;#39;, encoding=&amp;#39;utf-8&amp;#39;) as f: html_content = f.read() XPATH解析得到图片的xpath对象列表 1 2 3 4 5 6 def parse_xpath(html, xpath_stat): parse_html = etree.HTML(html) result_list = parse_html.xpath(xpath_stat) return result_list img_xpath_list = parse_xpath(html_content, &amp;#39;//img&amp;#39;) 得到图片链接的列表 1 2 3 4 5 6 7 8 9 10 11 12 13 def get_img_list(xpath_list): img_url_list = [] for item in xpath_list: url = item.</description></item></channel></rss>